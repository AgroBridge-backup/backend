# ══════════════════════════════════════════════════════════════════════════════
# KUBERNETES CONFIGMAP
# ══════════════════════════════════════════════════════════════════════════════
# Non-sensitive configuration for the AgroBridge API
# Secrets are stored separately in secrets.yaml (or external secret manager)
# ══════════════════════════════════════════════════════════════════════════════
apiVersion: v1
kind: ConfigMap
metadata:
  name: agrobridge-config
  namespace: agrobridge
  labels:
    app: agrobridge-api
    app.kubernetes.io/name: agrobridge-api
    app.kubernetes.io/component: config
data:
  # ────────────────────────────────────────────────────────────────────────────
  # Application Configuration
  # ────────────────────────────────────────────────────────────────────────────
  NODE_ENV: "production"
  PORT: "3000"
  LOG_LEVEL: "info"

  # ────────────────────────────────────────────────────────────────────────────
  # Database Configuration
  # ────────────────────────────────────────────────────────────────────────────
  POSTGRES_HOST: "postgres-service"
  POSTGRES_PORT: "5432"
  POSTGRES_DB: "agrobridge_prod"

  # ────────────────────────────────────────────────────────────────────────────
  # Redis Configuration
  # ────────────────────────────────────────────────────────────────────────────
  REDIS_HOST: "redis-service"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_TTL: "300"

  # ────────────────────────────────────────────────────────────────────────────
  # AWS Configuration
  # ────────────────────────────────────────────────────────────────────────────
  AWS_REGION: "us-east-1"
  S3_BUCKET: "agrobridge-production"

  # ────────────────────────────────────────────────────────────────────────────
  # CORS Configuration
  # ────────────────────────────────────────────────────────────────────────────
  CORS_ORIGIN: "https://agrobridge.io,https://www.agrobridge.io,https://app.agrobridge.io"

  # ────────────────────────────────────────────────────────────────────────────
  # Rate Limiting
  # ────────────────────────────────────────────────────────────────────────────
  RATE_LIMIT_WINDOW_MS: "900000"
  RATE_LIMIT_MAX_REQUESTS: "100"

  # ────────────────────────────────────────────────────────────────────────────
  # JWT Configuration (non-secret)
  # ────────────────────────────────────────────────────────────────────────────
  JWT_ACCESS_EXPIRY: "15m"
  JWT_REFRESH_EXPIRY: "7d"

  # ────────────────────────────────────────────────────────────────────────────
  # Feature Flags
  # ────────────────────────────────────────────────────────────────────────────
  ENABLE_CACHING: "true"
  ENABLE_METRICS: "true"
  ENABLE_SWAGGER: "false"
