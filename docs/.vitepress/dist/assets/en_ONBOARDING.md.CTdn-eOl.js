import{_ as e,c as i,o as a,ae as t}from"./chunks/framework.BQlYxExx.js";const c=JSON.parse('{"title":"Getting Started: AgroBridge API Developer Onboarding","description":"","frontmatter":{},"headers":[],"relativePath":"en/ONBOARDING.md","filePath":"en/ONBOARDING.md","lastUpdated":1764098389000}'),n={name:"en/ONBOARDING.md"};function p(l,s,o,h,r,d){return a(),i("div",null,[...s[0]||(s[0]=[t(`<h1 id="getting-started-agrobridge-api-developer-onboarding" tabindex="-1">Getting Started: AgroBridge API Developer Onboarding <a class="header-anchor" href="#getting-started-agrobridge-api-developer-onboarding" aria-label="Permalink to &quot;Getting Started: AgroBridge API Developer Onboarding&quot;">â€‹</a></h1><blockquote><p>ðŸ‡ªðŸ‡¸ <strong><a href="./../es/ONBOARDING.html">Leer esto en EspaÃ±ol</a></strong></p></blockquote><blockquote><p><strong>Audience:</strong> Software Engineers, DevOps <strong>Objective:</strong> This guide provides a complete, step-by-step process to set up the backend development environment from a clean machine.</p></blockquote><h2 id="_1-prerequisites" tabindex="-1">1. Prerequisites <a class="header-anchor" href="#_1-prerequisites" aria-label="Permalink to &quot;1. Prerequisites&quot;">â€‹</a></h2><p>Ensure the following software is installed on your machine:</p><ul><li><strong>Git:</strong> For cloning the repository.</li><li><strong>Node.js:</strong> Version <code>20.x</code> or higher.</li><li><strong>pnpm:</strong> Version <code>8.x</code> or higher. Install via <code>npm install -g pnpm</code>.</li><li><strong>Docker &amp; Docker Compose:</strong> For running dependent services (Database, Cache).</li></ul><h2 id="_2-step-by-step-setup" tabindex="-1">2. Step-by-Step Setup <a class="header-anchor" href="#_2-step-by-step-setup" aria-label="Permalink to &quot;2. Step-by-Step Setup&quot;">â€‹</a></h2><h3 id="step-2-1-clone-the-repository" tabindex="-1">Step 2.1: Clone the Repository <a class="header-anchor" href="#step-2-1-clone-the-repository" aria-label="Permalink to &quot;Step 2.1: Clone the Repository&quot;">â€‹</a></h3><p>Clone the main project repository to your local machine.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">repository-ur</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">repository-director</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><h3 id="step-2-2-configure-environment-variables" tabindex="-1">Step 2.2: Configure Environment Variables <a class="header-anchor" href="#step-2-2-configure-environment-variables" aria-label="Permalink to &quot;Step 2.2: Configure Environment Variables&quot;">â€‹</a></h3><p>The backend service (<code>apps/api</code>) requires specific environment variables to run.</p><ol><li><p><strong>Navigate to the API directory:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apps/api</span></span></code></pre></div></li><li><p><strong>Create the <code>.env</code> file:</strong> Copy the example file. This file is git-ignored and will contain your local secrets.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env</span></span></code></pre></div></li><li><p><strong>Edit the <code>.env</code> file:</strong> Open <code>apps/api/.env</code> and fill in the following variables.</p><div class="language-dotenv vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dotenv</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Backend server port</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">4000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Database connection URL for the Docker service</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">DATABASE_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;postgresql://agro_user:supersecretpassword@localhost:5432/agrobridge?schema=public&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Redis connection URL for the Docker service</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">REDIS_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;redis://localhost:6379&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Paths to JWT signing keys. Generate these locally.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># See Troubleshooting section for generating keys.</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">JWT_PRIVATE_KEY_PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./jwtRS256.key&quot;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">JWT_PUBLIC_KEY_PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./jwtRS256.key.pub&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Token time-to-live settings</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">JWT_ACCESS_TOKEN_TTL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;15m&quot;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">JWT_REFRESH_TOKEN_TTL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;7d&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># URL of the frontend for CORS configuration</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">FRONTEND_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:3000&quot;</span></span></code></pre></div></li></ol><h3 id="step-2-3-start-dependent-services" tabindex="-1">Step 2.3: Start Dependent Services <a class="header-anchor" href="#step-2-3-start-dependent-services" aria-label="Permalink to &quot;Step 2.3: Start Dependent Services&quot;">â€‹</a></h3><p>The backend requires a PostgreSQL database and a Redis instance. The <code>docker-compose.yml</code> file at the project root manages these services.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># From the project root directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redis</span></span></code></pre></div><p>This command starts the database and Redis containers in the background.</p><h3 id="step-2-4-install-dependencies" tabindex="-1">Step 2.4: Install Dependencies <a class="header-anchor" href="#step-2-4-install-dependencies" aria-label="Permalink to &quot;Step 2.4: Install Dependencies&quot;">â€‹</a></h3><p>Use <code>pnpm</code> from the root of the monorepo to install all dependencies for every project, including the <code>apps/api</code> backend.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># From the project root directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre></div><h3 id="step-2-5-prepare-the-database" tabindex="-1">Step 2.5: Prepare the Database <a class="header-anchor" href="#step-2-5-prepare-the-database" aria-label="Permalink to &quot;Step 2.5: Prepare the Database&quot;">â€‹</a></h3><ol><li><p><strong>Run Migrations:</strong> Apply the database schema.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># From the apps/api directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><p>This command will set up all tables and relationships in the <code>agrobridge</code> database.</p></li><li><p><strong>Seed the Database:</strong> Populate the database with initial data (e.g., admin user, test producers).</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># From the apps/api directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma:seed</span></span></code></pre></div></li></ol><h3 id="step-2-6-run-the-application" tabindex="-1">Step 2.6: Run the Application <a class="header-anchor" href="#step-2-6-run-the-application" aria-label="Permalink to &quot;Step 2.6: Run the Application&quot;">â€‹</a></h3><p>You are now ready to start the backend server.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># From the apps/api directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><p>The API will start on the port defined in your <code>.env</code> file (e.g., <code>http://localhost:4000</code>). The server will automatically restart when you make changes to the source code.</p><p><strong>You have successfully set up the AgroBridge API backend!</strong></p><h2 id="_3-troubleshooting-common-issues" tabindex="-1">3. Troubleshooting Common Issues <a class="header-anchor" href="#_3-troubleshooting-common-issues" aria-label="Permalink to &quot;3. Troubleshooting Common Issues&quot;">â€‹</a></h2><ul><li><p><strong>Error: <code>listen EADDRINUSE: address already in use :::4000</code></strong></p><ul><li><strong>Cause:</strong> Another process is using port 4000.</li><li><strong>Solution:</strong> Stop the other process or change the <code>PORT</code> in your <code>apps/api/.env</code> file to a different one (e.g., <code>4001</code>).</li></ul></li><li><p><strong>Error: Can&#39;t connect to database</strong></p><ul><li><strong>Cause:</strong> The Docker database container is not running or the <code>DATABASE_URL</code> is incorrect.</li><li><strong>Solution:</strong><ol><li>Verify the containers are running with <code>docker ps</code>.</li><li>Ensure your <code>DATABASE_URL</code> in <code>.env</code> matches the credentials in the <code>docker-compose.yml</code> file.</li><li>Check that you are using <code>localhost</code> or <code>127.0.0.1</code> and not <code>db</code> in your connection string for local development.</li></ol></li></ul></li><li><p><strong>Error: <code>ENOENT: no such file or directory, open &#39;./jwtRS256.key&#39;</code></strong></p><ul><li><strong>Cause:</strong> The JWT signing keys have not been generated. The application requires an RSA key pair to sign tokens.</li><li><strong>Solution:</strong> Generate a new key pair in the <code>apps/api</code> directory.<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># In the apps/api directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh-keygen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rsa</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2048</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PEM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jwtRS256.key</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rsa</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jwtRS256.key</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pubout</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -outform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PEM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jwtRS256.key.pub</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Do not add a passphrase when prompted.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ensure the .key files are added to .gitignore and never committed.</span></span></code></pre></div></li></ul></li></ul>`,29)])])}const g=e(n,[["render",p]]);export{c as __pageData,g as default};
